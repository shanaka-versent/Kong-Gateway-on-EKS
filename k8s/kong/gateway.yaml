# Kong Gateway Resource
# @author Shanaka Jayasundera - shanakaj@gmail.com
#
# This Gateway routes traffic from the Terraform-managed Internal NLB to backend services.
# Traffic flow: CloudFront (WAF) --> VPC Origin --> Internal NLB --> Kong Gateway --> Services
#
# NOTE: NLB is managed by Terraform (not by LB Controller annotations).
# Kong pods are registered with the NLB via TargetGroupBinding CRD.

apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: kong-gateway
  namespace: kong
  # NOTE: AWS NLB annotations removed - NLB is Terraform-managed for CloudFront VPC Origin
spec:
  gatewayClassName: kong
  listeners:
    - name: http
      protocol: HTTP
      port: 80
      allowedRoutes:
        namespaces:
          from: All
