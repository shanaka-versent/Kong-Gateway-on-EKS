# Kong Konnect Integration - Reference Values
# @author Shanaka Jayasundera - shanakaj@gmail.com
#
# SPLIT DEPLOYMENT: Kong Gateway + KIC are deployed as separate Helm releases.
# These values are for reference only â€” the actual config is inline in:
#   - argocd/apps/02-kong-gateway.yaml   (data plane)
#   - argocd/apps/02b-kong-controller.yaml (KIC + Konnect)
#
# Konnect Control Plane: Test-GW (AU region)
# CP ID: 31c96ad8-651b-40b6-92e9-b9ab8dae1cdf

# ==============================================================================
# DATA PLANE VALUES (02-kong-gateway.yaml)
# ==============================================================================

image:
  repository: kong/kong-gateway
  tag: "3.9"

ingressController:
  enabled: false  # KIC is a separate release

env:
  role: data_plane
  database: "off"
  konnect_mode: "on"
  vitals: "off"
  cluster_mtls: pki
  cluster_control_plane: "b5ec5fb109.au.cp.konghq.com"
  cluster_telemetry_endpoint: "b5ec5fb109.au.tp.konghq.com:443"
  cluster_telemetry_server_name: "b5ec5fb109.au.tp.konghq.com"
  cluster_cert: /etc/secrets/kong-cluster-cert/tls.crt
  cluster_cert_key: /etc/secrets/kong-cluster-cert/tls.key
  lua_ssl_trusted_certificate: system

secretVolumes:
  - kong-cluster-cert

admin:
  enabled: true
  type: ClusterIP
  http:
    enabled: true
    containerPort: 8001

proxy:
  enabled: true
  type: ClusterIP
  http:
    enabled: true
    containerPort: 8000
    servicePort: 80
  tls:
    enabled: true
    containerPort: 8443
    servicePort: 443

status:
  enabled: true
  http:
    enabled: true
    containerPort: 8100

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

tolerations:
  - key: "CriticalAddonsOnly"
    operator: "Exists"
    effect: "NoSchedule"

podDisruptionBudget:
  enabled: true
  minAvailable: 1

replicaCount: 2
